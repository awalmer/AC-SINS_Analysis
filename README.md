# Introduction: AC-SINS Analysis R Shiny Application
This is an R Shiny application that I developed at Eli Lilly &amp; Co. R Shiny is an R package that allows developers to build and deploy interactive web applications. For our team's purposes, R Shiny was an excellent resource for sharing our newly-developed AC-SINS analysis approach with users. 

  The R script for the application is [app.R](/app.R), and the required supplmental script of functions sourced by the application is [functions.R](/functions.R). 

  The original application, intended for usage by Eli Lilly scientists, is hosted on Eli Lilly's server at this location: https://shiny.am.lilly.com/acsins_analysis/.
  For the purpose of open source access, the application can also be found here: []. Note: This version is hosted on [shinyapps.io](https://www.shinyapps.io/) and has a 25 Active Hour limit per month. 


# Background on AC-SINS
AC-SINS stands for Affinity-Capture Self-Interaction Nanoparticle Spectroscopy.  

# AC-SINS Analysis & LOESS


We realized that AC-SINS analysis was not an exercise in data prediction, but rather required a description of the data. We merely needed to describe the data on a case-by-case basis rather than find a mathematical function that would fit all cases of AC-SINS data. We focused on the fact that the plotted data always had only one global maximum, and that scientists were interested in identifying the wavelength at the peak of the data after the removal of outlying points. We found that by smoothing the data, we could remove noise around the peak and capture a reliable plasmon wavelength estimation. We decided to apply the LOESS (term referring to “local regression”) method, which involves fitting a scatterplot using multiple regression models in a k-nearest-neighbor-based meta-model.[1] As opposed to a parametric fit, the loess curve is “obtained empirically rather than through stringent prior specifications about the nature of any structure that might exist within the data” (Jacoby, 578).[2] For each local data point and its specified neighborhood, a separate regression is applied iteratively for each region. This method is suitable for our task of capturing the plasmon wavelength because we want to describe the behavior of the data around the peak and remove noise caused by outlying points.

# Features of the Application
The application includes several useful **features**. Upon uploading raw AC-SINS data (from plate reader) and corresponding sample name data, the user can view an array of tables and plots that give insight to important outcomes. The user is first able to view the raw data that he/she uploaded in order to confirm that it is correct, and then can view the first summary table, which is in 384-well format, modeled after a plate in the context of the experiment. The 384-well summary table contains the sample, buffer, and control information, the plasmon wavelength peak determined by our implementation of the LOESS method, and additional information such as standard error, as well as minimum and maximum absorbance values. The next table is the summary table in 96-well plate format, which combines the results from the quadruplicate wells corresponding to the same sample. This allows the user to view the averaged plasmon wavelength value across 4 wells, the standard deviation of that value, and the individual readings for comparison. The user can also view the average plasmon wavelength values for the buffers and controls in the data. The 96-well view allows the user to see how the individual absorbance readings are varying for a given sample. In addition to the normal 96-well plate table, there is an optimized version of the table that the user can manipulate – the user can set a threshold value for the number of standard deviations away from average plasmon wavelength, for which any individual plasmon wavelength values falling beyond that threshold will be removed from the calculation. This helps to systematically remove outliers from the results, allowing the user to view a more optimal version of the data.  

The application also has several **visualization features**. First, there is a plot view for individual wells from the 384-well plate, which gives an up-close view of the data points and plasmon wavelength outcome for an absorbance reading for a single sample. The user can select the sample name and buffer name combination from a drop-down menu to view this individual plot. Next, the user can view two different plot grids: each showing the top eight plots of concern based on two parameters. The first grid contains the top eight plots of concern based on the “percent in range” goodness-of-fit parameter, which is calculated by taking the Root Mean Squared Error of the Loess Model and doubling it, then assessing what proportion of points in the plot fall within that distance from the Loess curve. This number reflects how reliable the Loess model is for a given plot. This method functions as a pseudo-confidence-interval assessment. If it is a good “curve fit,” 90% of the data points should fall within 2 RMSE measurements. The second grid contains the top eight plots of concern based on the Root Mean Squared Error (RMSE), which gives us a measure of the noisiness of the data. That is, it tells us how much the error (distance from data point to Loess curve) varies. The formula for RMSE is the square root of the following: the sum of (loess value - raw value) squared, divided by the total number of data points. The final visualization feature available in the application is a multi-curve plot, which allows the user to combine loess smooth lines for up to eight different sample-buffer combinations in the same plot. Each loess line and plotted plasmon wavelength value takes on a different color, and the user can have vertical lines inserted to intersect the plasmon wavelength value for each loess line. This is a very useful tool for plasmon wavelength outcome comparison as well as data shape. Last but not least, the application contains a table which orders all wells by the two “goodness-of-fit" parameters (percent in range and RMSE), based on how the user chooses to filter it. This is a useful table in the context of the visualizations because the user can take a look at the worst data of the experiment, and visualize whether it is of great concern or not. 

# Workflow / How to Use the Application
The workflow of AC-SINS analysis is as follows. To begin, the user prepares the raw AC-SINS data output from the experiment, as well as a sample name file, which contains sample information in a 384-well format. These two files are then uploaded to the AC-SINS Analysis R Shiny application, and the application initiates the generation of all tables and visualizations that support the analysis process. The user may then view the resulting plasmon wavelength (as well as additional results) per sample quadruplicate, as determined by the LOESS method. Simply stated, LOESS is a smoothing method that removes noise from the data, isolating a peak value from the newly described data. Upon consideration of the results, plots, and data quality, the user can then optimize and download any visualization, and download conditionally formatted reports from the application to use for his or her presentation purposes.

## **Step 1: Uploading Data Files**
There is anonymyzed example data available in this repository, in the "data" folder. The file named "raw.xlsx" can be uploaded to the ___ and the file named "names.xlsx" can be upload to the ___ input. 

## **Step 2: Explore the Application!**

## **Step 3: Download Plots and Reports**
